.. _dm-test:

设备管理平台测试
==================

单元测试
-----------

此部分文档主要介绍顶点云设备管理平台的单元测试。你可以在源码目录下运行 `python manage.py test` 运行全部单元测试。

单元测试主要覆盖用户登录、注册、设备创建、修改、信息更新、命令执行等，各单元测试文件覆盖视图函数如下表所示。

+---------------------------------+-------------------------------------------------------------+
| 单元测试文件名                  |  测试覆盖视图函数                                           |
+=================================+=============================================================+
| `test_basic.py`                 |  测试环境是否正常，服务器是否启动                           |
+---------------------------------+-------------------------------------------------------------+
| `test_client1.py`               |  `show_status`、`update_status`、                           |
|                                 |  `get_history`、`show_history`、                            |
|                                 |  `newdevie`、`edit_device`、`delete_device`、               |
|                                 |  `set_status`、`set_interval`、`reset_token`、              |
|                                 |  `index`、`home`、`user`                                    |
+---------------------------------+-------------------------------------------------------------+
| `test_client2.py`               |  `login`、`logout`、`register`、`confirm`、                 |
|                                 |  `resend_confirmation`、`change_email_request`、            |
|                                 |  `change_email`、`password_reset`、`secure_center`、        |
|                                 |  `before_request`、`unconfirmed`                            |
+---------------------------------+-------------------------------------------------------------+

手动测试报告
-----------------

此部分报告由 `non1996`_ 测试并编写。

用户认证
>>>>>>>>>>>>>

+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例名称 |        登陆                    | 标识 |         TEST-1                                     |
+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例综述 |        检验用户登陆正确性                                                                  |
+--------------+--------------------------------------------------------------------------------------------+
| 用例初始化   |        管理员权限账户用户名：test@test.com，密码：TESTTHISPASSWORD                         |
+--------------+--------------------------------------------------------------------------------------------+
|                                                测试步骤                                                   |
+--------+------------------------------+---------------------------------+---------------------------------+
|  序号  |  操作                        |  期望结果                       |  实测结果                       |
+--------+------------------------------+---------------------------------+---------------------------------+
|  1     |  在系统登录界面中输入正确    |  可正常登陆，登陆后页面跳转到   |  与预期结果一致。               |
|        |  的测试用户名和正确登陆密    |  设备详细信息页面。             |                                 |
|        |  码。                        |                                 |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  2     |  在系统登录界面中输入错误    |  登陆页面弹出登陆失败提示，告   |  与预期结果一致。               |
|        |  的用户名或错误登陆密码。    |  知用户用户名或密码错误。       |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+

设备管理
>>>>>>>>>>>>>>>

+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例名称 |        设备信息管理            | 标识 |         TEST-2                                     |
+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例综述 |        检验设备管理界面操作的正确性                                                        |
+--------------+--------------------------------------------------------------------------------------------+
| 用例初始化   |        预制的模拟设备                                                                      |
+--------------+--------------------------------------------------------------------------------------------+
|                                                测试步骤                                                   |
+--------+------------------------------+---------------------------------+---------------------------------+
|  序号  |  操作                        |  期望结果                       |  实测结果                       |
+--------+------------------------------+---------------------------------+---------------------------------+
|  1     |  点击设备操作中的“详细”      |  进入对应设备的详细信息界面。   |  与预期结果一致。               |
|        |  按钮。                      |                                 |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  2     |  点击设备操作中的“历史”      |  进入对应设备的历史信息界面。   |  与预期结果一致。               |
|        |  按钮。                      |                                 |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  3     |  点击设备操作中的“删除”      |  弹出确认框，点击确认后，网页   |  与预期结果一致。               |
|        |  按钮。                      |  向服务器发出请求，设备从模拟   |                                 |
|        |                              |  程序上删除，网页不再显示设备   |                                 | 
|        |                              |  信息。                         |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  4     |  点击“创建新设备”按钮。      |  弹出模态对话框，在输入设备名   |  与预期结果一致。               |
|        |                              |  称、设备简介、监控间隔并选择   |                                 |
|        |                              |  设备后，网页向服务器发出添加   |                                 |
|        |                              |  请求，在模拟程序上添加相应类   |                                 |
|        |                              |  型的设备，网页开始接收该设备   |                                 |
|        |                              |  信息并显示。                   |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  5     |  点击侧边栏页面索引按钮。    |  跳转到相应页面。               |  与预期结果一致。               |
+--------+------------------------------+---------------------------------+---------------------------------+
|  6     |  点击用户头像，并在弹出的    |  点击“账户资料”后，跳转到账     |  与预期结果一致。               |
|        |  下拉框中点击“账户资料”      |  户资料页面，用户可设置用户头   |                                 |
|        |  和“安全中心”。              |  像，昵称，及用户简介。点击“    |                                 |
|        |                              |  安全中心”后，跳转到安全中心    |                                 |
|        |                              |  页面，用户可在此页面更换登陆   |                                 |
|        |                              |  邮箱和修改登陆密码。           |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  7     |  点击设置按钮。              |  弹出对话框，输入刷新间隔后，   |  与预期结果一致。               |
|        |                              |  改变页面向服务器发送ajax刷新   |                                 |
|        |                              |  界面请求的间隔。               |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+

详细界面
>>>>>>>>>>>>>

+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例名称 |        设备详细信息页面测试    | 标识 |         TEST-3                                     |
+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例综述 |        检验各设备详细信息界面显示和操作的正确性                                            |
+--------------+--------------------------------------------------------------------------------------------+
| 用例初始化   |        预制的模拟设备                                                                      |
+--------------+--------------------------------------------------------------------------------------------+
|                                                界面显示测试                                               |
+-----------------------------------------------------------------------------------------------------------+
| 能够显示模拟设备的电流、电话、功率、设备温度，并能以动态的图表将其变化过程实时展现给用户。除了上述基本    |
| 属性，针对不同设备，能显示其特有的属性变化情况，如电灯光线饱和度、电视画面、空调所处室内温度等。          |
| 对于实体设备，如计算机，能显示CPU、内存、磁盘的使用情况和CPU、GPU温度情况。                               |
+-----------------------------------------------------------------------------------------------------------+
|                                                测试步骤                                                   |
+--------+------------------------------+---------------------------------+---------------------------------+
|  序号  |  操作                        |  期望结果                       |  实测结果                       |
+--------+------------------------------+---------------------------------+---------------------------------+
|  1     |  点击设备开关按钮。          |  当设备运行时，单击按钮能停止   |  与预期结果一致。               |
|        |                              |  模拟程序对该设备的模拟，设备   |                                 | 
|        |                              |  状态信息不再变化。当设备未开   |                                 | 
|        |                              |  启时，单击按钮能使程序继续对   |                                 | 
|        |                              |  设备状态模拟，设备状态开始变   |                                 |
|        |                              |  化。                           |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  2     |  点击设备监控间隔的按钮。    |  点击“+” 能增加网页向服务器     |  与预期结果一致。               |
|        |                              |  请求数据的间隔，上限为10，点   |                                 |
|        |                              |  击“-” 能降低网页向服务器请     |                                 | 
|        |                              |  的速率，下限为1。点击后设备    |                                 |
|        |                              |  各数据刷新频率改变。           |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  3     |  点击电灯页面设置亮度按钮。  |  单击左边按钮能降低电灯亮度，   |  与预期结果一致。               |
|        |                              |  下限为1，单击右边按钮能提高电  |                                 |
|        |                              |  灯亮度，上限为5，点击后改变模  |                                 |
|        |                              |  拟程序中电灯亮度值。           |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  4     |  点击电视界面设置频道按钮。  |  电视频道能在1到9之间切换，切   |  与预期结果一致。               |
|        |                              |  换频道后，网页显示的节目画面   |                                 |
|        |                              |  能进行切换。                   |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  5     |  转动电视页面音量设置旋钮。  |  鼠标松开后，将当前音量值发送   |  与预期结果一致。               |
|        |                              |  给模拟程序，改变模拟程序中电   |                                 |
|        |                              |  视的音量值。                   |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  6     |  转动空调页面温度设置旋钮    |  鼠标松开后，将当前温度值发送   |  与预期结果一致。               |
|        |  下拉框中点击“账户资料”      |  给模拟程序，改变模拟程序中空   |                                 |
|        |  和“安全中心”。              |  调温度值。                     |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+
|  7     |  点击空调页面制冷/制热按钮。 |  当按钮为红色时，点击后设置模   |  与预期结果一致。               |
|        |                              |  拟程序中空调的模式为制冷，当   |                                 |
|        |                              |  按钮为白色时，点击后设置空调   |                                 |
|        |                              |  的模式为制热。                 |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+

历史记录
>>>>>>>>>>>>

+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例名称 |        设备历史信息页面测试    | 标识 |         TEST-4                                     |
+--------------+--------------------------------+------+----------------------------------------------------+
| 测试用例综述 |        检验各设备历史信息界面显示和操作的正确性                                            |
+--------------+--------------------------------------------------------------------------------------------+
| 用例初始化   |        预制的模拟设备                                                                      |
+--------------+--------------------------------------------------------------------------------------------+
|                                                界面显示测试                                               |
+-----------------------------------------------------------------------------------------------------------+
| 能够显示模拟设备的电流、电话、功率、设备温度在某个小时内的历史记录。能显示实体计算机设备的内存使用        |
| 率等信息。                                                                                                |    
+-----------------------------------------------------------------------------------------------------------+
|                                                测试步骤                                                   |
+--------+------------------------------+---------------------------------+---------------------------------+
|  序号  |  操作                        |  期望结果                       |  实测结果                       |
+--------+------------------------------+---------------------------------+---------------------------------+
|  1     |  选择要查询的设备历史时间    |  历史信息能正常显示             |  与预期结果一致。               |
|        |  区间后，点击查询按钮。      |                                 |                                 |
+--------+------------------------------+---------------------------------+---------------------------------+


到这里顶点云设备管理平台的开发者文档部分就结束了，您可以继续阅读 :ref:`dm-design` 来查看我们对设计者提出的几点建议。

.. _non1996: https://github.com/non1996