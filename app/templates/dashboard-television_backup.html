
<script type="text/javascript">
	jQuery(document).ready(function($) {
					// Notifications
		setTimeout(function() {
			var opts = {
				"closeButton": true,
				"debug": false,
				"positionClass": "toast-top-right toast-default",
				"toastClass": "black",
				"onclick": null,
				"showDuration": "100",
				"hideDuration": "1000",
				"timeOut": "5000",
				"extendedTimeOut": "1000",
				"showEasing": "swing",
				"hideEasing": "linear",
				"showMethod": "fadeIn",
				"hideMethod": "fadeOut"
			};
				
						//toastr.info("You have been awarded with 1 year free subscription. Enjoy it!", "Account Subcription Updated", opts);
		}, 3000);
					
					// Charts
		var xenonPalette = ['#68b828','#7c38bc','#0e62c7','#fcd036','#4fcdfc','#00b19d','#ff6264','#f7aa47'];

		// Pageviews Visitors Chart
		var i = 0,
			line_chart_data_source = [];
		for(var i = 0; i < 30; ++i){
			line_chart_data_source.push({id: ++i, part1: 0});
		}


		$("#pageviews-visitors-chart").dxChart({
			dataSource: line_chart_data_source,
			commonSeriesSettings: {
				argumentField: "id",
				point: { visible: true, size: 5, hoverStyle: {size: 7, border: 0, color: 'inherit'} },
				line: {width: 1, hoverStyle: {width: 1}}
			},
			series: [
				{ valueField: "part1", name: "电流", color: "#68b828" }
				//{ valueField: "part2", name: "Visitors", color: "#68b828" },
			],
			legend: {
				position: 'inside',
				paddingLeftRight: 5
			},
			commonAxisSettings: {
				label: {
					visible: false
				},
				grid: {
					visible: true,
					color: '#f9f9f9'
				}
			},
			valueAxis: {
				max: 25
			},
			argumentAxis: {
				valueMarginsEnabled: false
			},
		}).data('iCount', i);

					// Server Uptime Chart
		var bar1_data_source = [
			{ year: 1, 	europe: 10, americas: 0, africa: 5 },
			{ year: 2, 	europe: 20, americas: 5, africa: 15 },
			{ year: 3, 	europe: 30, americas: 10, africa: 15 },
			{ year: 4, 	europe: 40, americas: 15, africa: 30 },
			{ year: 5, 	europe: 30, americas: 10, africa: 20 },
			{ year: 6, 	europe: 20, americas: 5,  africa: 10 },
			{ year: 7, 	europe: 10, americas: 15, africa: 0 },
			{ year: 8, 	europe: 20, americas: 25, africa: 8 },
			{ year: 9, 	europe: 30, americas: 35, africa: 16 },
			{ year: 10,	europe: 40, americas: 45, africa: 24 },
			{ year: 11,	europe: 50, americas: 40, africa: 32 },
		];

		$("#server-uptime-chart").dxChart({
			dataSource: [
				{id: ++i, 	sales: 1},
				{id: ++i, 	sales: 2},
				{id: ++i, 	sales: 3},
				{id: ++i, 	sales: 4},
				{id: ++i, 	sales: 5},
				{id: ++i, 	sales: 4},
				{id: ++i, 	sales: 5},
				{id: ++i, 	sales: 6},
				{id: ++i, 	sales: 7},
				{id: ++i, 	sales: 6},
				{id: ++i, 	sales: 5},
				{id: ++i, 	sales: 4},
				{id: ++i, 	sales: 5},
				{id: ++i, 	sales: 4},
				{id: ++i, 	sales: 4},
				{id: ++i, 	sales: 3},
				{id: ++i, 	sales: 4},
			],
					 
			series: {
				argumentField: "id",
				valueField: "sales",
				name: "Sales",
				type: "bar",
				color: '#7c38bc'
			},
			commonAxisSettings: {
				label: {
					visible: false
				},
				grid: {
					visible: false
				}
			},
			legend: {
				visible: false
			},
			argumentAxis: {
				valueMarginsEnabled: true
			},
			valueAxis: {
				max: 12
			},
			equalBarWidth: {
				width: 11
			}
		}).data('iCount', i);
					
					// Average Sales Chart
		var doughnut1_data_source = [
			{region: "0.1", val: 20},
			{region: "0.2", val: 15},
			{region: "0.3", val: 5},
			{region: "0.4", val: 7},
			{region: "0.5", val: 10},
			{region: "0.6", val: 30},
			{region: "0.7", val: 2},
			{region: "0.8", val: 10},
			{region: "0.9", val: 19},
			{region: "1.0", val: 50},
		], timer;
					
		$("#sales-avg-chart div").dxPieChart({
			dataSource: doughnut1_data_source,
			tooltip: {
				enabled: false,
				format:"millions",
				customizeText: function() {
					return this.argumentText + "<br/>" + this.valueText;
				}
			},
			size: {
				height: 90
			},
			legend: {
				visible: false
			},
			series: [{
				type: "doughnut",
				argumentField: "region"
			}],
			palette: ['#5e9b4c', '#6ca959', '#b9f5a6'],
		});
					
					// Pageview Stats
		$('#pageviews-stats').dxBarGauge({
			startValue: -50,
			endValue: 50,
			baseValue: 0,
			values: [-21.3, 14.8, -30.9, 45.2],
			label: {
				customizeText: function (arg) {
					return arg.valueText + '%';
				}
			},
			//palette: 'ocean',
			palette: ['#68b828','#7c38bc','#0e62c7','#fcd036','#4fcdfc','#00b19d','#ff6264','#f7aa47'],
			margin : {
				top: 0
			}
		});

		var firstMonth = {
				dataSource: getFirstMonthViews(),
				argumentField: 'month',
				valueField: '2014',
				type: 'area',
				showMinMax: true,
				lineColor: '#68b828',
				minColor: '#68b828',
				maxColor: '#7c38bc',
				showFirstLast: false,
			},
			secondMonth = {
				dataSource: getSecondMonthViews(),
				argumentField: 'month',
				valueField: '2014',
				type: 'splinearea',
				lineColor: '#68b828',
				minColor: '#68b828',
				maxColor: '#7c38bc',
				pointSize: 6,
				showMinMax: true,
				showFirstLast: false
			},
			thirdMonth = {
				dataSource: getThirdMonthViews(),
				argumentField: 'month',
				valueField: '2014',
				type: 'splinearea',
				lineColor: '#68b828',
				minColor: '#68b828',
				maxColor: '#7c38bc',
				pointSize: 6,
				showMinMax: true,
				showFirstLast: false
			};

		function getFirstMonthViews() {
			return [{ month: 1, 2014: 7341 },
				{ month: 2, 2014: 7016 },
				{ month: 3, 2014: 7202 },
				{ month: 4, 2014: 7851 },
				{ month: 5, 2014: 7481 },
				{ month: 6, 2014: 6532 },
				{ month: 7, 2014: 6498 },
				{ month: 8, 2014: 7191 },
				{ month: 9, 2014: 7596 },
				{ month: 10, 2014: 8057 },
				{ month: 11, 2014: 8373 },
				{ month: 12, 2014: 8636 }];
		};

		function getSecondMonthViews() {
			return [{ month: 1, 2014: 189742 },
				{ month: 2, 2014: 181623 },
				{ month: 3, 2014: 205351 },
				{ month: 4, 2014: 245625 },
				{ month: 5, 2014: 261319 },
				{ month: 6, 2014: 192786 },
				{ month: 7, 2014: 194752 },
				{ month: 8, 2014: 207017 },
				{ month: 9, 2014: 212665 },
				{ month: 10, 2014: 233580 },
				{ month: 11, 2014: 231503 },
				{ month: 12, 2014: 232824 }];
		};
					
		function getThirdMonthViews() {
			return [{ month: 1, 2014: 398},
				{ month: 2, 2014: 422},
				{ month: 3, 2014: 431},
				{ month: 4, 2014: 481},
				{ month: 5, 2014: 551},
				{ month: 6, 2014: 449},
				{ month: 7, 2014: 442},
				{ month: 8, 2014: 482},
				{ month: 9, 2014: 517},
				{ month: 10, 2014: 566},
				{ month: 11, 2014: 630},
				{ month: 12, 2014: 737}];
		};
					
					
		$('.first-month').dxSparkline(firstMonth);
		$('.second-month').dxSparkline(secondMonth);
		$('.third-month').dxSparkline(thirdMonth);
					
					// Realtime Network Stats
		var i = 0,
			rns_values = [130,150],
			rns2_values = [39,50],
			realtime_network_stats = [];

		for(i=0; i<=100; i++) {
			realtime_network_stats.push({ id: i, x1: 0, x2: 0});
		}

		$("#realtime-network-stats").dxChart({
			dataSource: realtime_network_stats,
			commonSeriesSettings: {
				type: "area",
				argumentField: "id"
			},
			series: [
				{ valueField: "x1", name: "Packets Sent", color: '#7c38bc', opacity: .4 },
				{ valueField: "x2", name: "Packets Received", color: '#000', opacity: .5},
			],
			legend: {
				verticalAlignment: "bottom",
				horizontalAlignment: "center"
			},
			commonAxisSettings: {
				label: {
					visible: false
				},
				grid: {
					visible: true,
					color: '#f5f5f5'
				}
			},
			legend: {
				visible: false
			},
			argumentAxis: {
				valueMarginsEnabled: false
			},
			valueAxis: {
				max: 500
			},
			animation: {
				enabled: false
			}
		}).data('iCount', i);

		$('#network-realtime-gauge').dxCircularGauge({		//设备温度转盘
			scale: {
				startValue: 0,
				endValue: 100,
				majorTick: {
					tickInterval: 25
				}
			},
			rangeContainer: {
				palette: 'pastel',
				width: 3,
				ranges: [
					{ startValue: 0, endValue: 25, color: "#68b828" },
					{ startValue: 25, endValue: 50, color: "#faff01" },
					{ startValue: 50, endValue: 75, color: "#ffb801" },
					{ startValue: 75, endValue: 100, color: "#ff3201" },
				],
			},
			value: 100,
			valueIndicator: {
				offset: 10,
				color: '#7c38bc',
				type: 'triangleNeedle',
				spindleSize: 12
			}
		});
		setInterval(function () {
			myTotalChange();
		}, 2000);
					
					// CPU Usage Gauge
		$("#cpu-usage-gauge").dxCircularGauge({		//CPU利用率转盘设置
			scale: {
				startValue: 0,
				endValue: 100,
				majorTick: {
					tickInterval: 25
				}
			},
			rangeContainer: {
				palette: 'pastel',
				width: 3,
				ranges: [
					{ startValue: 0, endValue: 25, color: "#68b828" },
					{ startValue: 25, endValue: 50, color: "#faff01" },
					{ startValue: 50, endValue: 75, color: "#ffb801" },
					{ startValue: 75, endValue: 100, color: "#ff3201" },
				],
			},
			value: between(30, 90),
			valueIndicator: {
				offset: 10,
				color: '#68b828',
				type: 'rectangleNeedle',
				spindleSize: 12
			}
		});
		// Resize charts
		$(window).on('xenon.resize', function() {
			$("#pageviews-visitors-chart").data("dxChart").render();
			$("#server-uptime-chart").data("dxChart").render();
			$("#realtime-network-stats").data("dxChart").render();

			$('.first-month').data("dxSparkline").render();
			$('.second-month').data("dxSparkline").render();
			$('.third-month').data("dxSparkline").render();
		});
	});
//-----------------------------------------------------------------------------------------------------------------------------从服务器接收ajax信息动态刷新界面
				//ajax刷新
	function getAjaxFromServer(){
		$.post('/show_status/', {
			'request':{
				'token': jQuery("#info_token").val(),
				'email': jQuery("#info_email").val(),
				'code': jQuery("#info_code").val()
			}
		}).done(function (data) {
			if('list' in data){
				var info = data['list'];
				var code = info.keys()[0];
				var voltage = info[code].volume;		//电压
				var eletricity = info[code].current;	//电流
				var power = voltage * eletricity;		//功率
				var degree = info[code].temperature;	//设备温度
				if(info[code].type == "Bulb"){
					var saturability = info[code].full;		//饱和度
					var light = info[code].lightDegree;		//亮度
					mySaturabilityChange(saturability);
				}
				var image = info[code].image;
				myDegreeStateChange(degree);
				myEleAndVolChange(voltage, eletricity);
				myTelevisionChange(null);				//修改画面
			}
		}).fail(function (data){
			console.log("失败");
		});
	}

	function myTotalChange(){
		getAjaxFromServer();
		myDegreeStateChange(0);						//设置温度
		myEleAndVolChange(0, 0);					//设置电压电流功率
		myRoomDegreeChange(0);						//室内温度
	}



				//--------------------------------------------电流图
	function myElectricityChange(range){
		$('#Light').text(range + 'A');
		var light_data = $('#pageviews-visitors-chart').dxChart('instance').option('dataSource');
		var count = $('#pageviews-visitors-chart').data('iCount');
		$('#pageviews-visitors-chart').data('iCount', count + 1);
		light_data.shift();
		light_data.push({id: count + 1, part1: range/5, part2: range/5});
		$('#pageviews-visitors-chart').dxChart('instance').option('dataSource', light_data);
	}
				//-------------------------------------------电压电流功率变化
	function myEleAndVolChange(vol, ele){
		var power = vol * ele;
		$('#Power').text(power + "W");
		$('#Electricity').text(ele + "A");
		$('#Voltage').text(vol + "V");
		myElectricityChange(ele);
		myVoltageGraphChange(vol);
	}
				//--------------------------------------------电压图变化
	function myVoltageGraphChange(range){
		$('#Dianya').text(range + 'V');
		var PowerData = $('#server-uptime-chart').dxChart('instance').option('dataSource');
		var count = $('#server-uptime-chart').data('iCount');
		$('#server-uptime-chart').data('iCount', count + 1);
		PowerData.shift();
		PowerData.push({id: count + 1, sales: range/30});
		$('#server-uptime-chart').dxChart('instance').option('dataSource', PowerData);
	}
				//-------------------------------------------室内温度变化
	function myRoomDegreeChange(range){
		var saturability = [];
		saturability.push({region: "0.1", val: range});
		saturability.push({region: "0.2", val: 100 - range});
		jQuery('#roomDegree').text(range+'℃');
		jQuery('#sales-avg-chart div').dxPieChart('instance').option('dataSource', saturability);
	}

				//------------------------------------------自定义温度变化函数, 改变三个组件
	function myDegreeStateChange(degree) {
		var nr_gauge = jQuery('#network-realtime-gauge').dxCircularGauge('instance');
		nr_gauge.value(degree);
		var $el = jQuery("#network-mbs-packets"),
			options = {
				useEasing : true,
				useGrouping : true,
				separator : ',',
				decimal : '.',
				prefix : '' ,
				suffix : '℃'
			},
			cntr = new countUp($el[0], parseFloat($el.text().replace('℃')), parseFloat(degree), 2, 1.5, options);
		cntr.start();
		var $ = jQuery,
			i = 0;
		var chart_data = $('#realtime-network-stats').dxChart('instance').option('dataSource');
		var count = $('#realtime-network-stats').data('iCount');
		$('#realtime-network-stats').data('iCount', count + 1);

		chart_data.shift();
		chart_data.push({id: count + 1, x1: degree, x2: degree});
		$('#realtime-network-stats').dxChart('instance').option('dataSource', chart_data);
	}

				//------------------------------------------设置电视画面
	function myTelevisionChange(src){
		if (src == null){
		    console.log("nifosfse");
			$("#television").attr("src", "assets\images\album-image-full.jpg");
		}
		$("#television").attr("src", src);
	}
	function networkRealtimeChartTick(min_max, min_max2) {
		var $ = jQuery,
			i = 0;
		var chart_data = $('#realtime-network-stats').dxChart('instance').option('dataSource');
		var count = $('#realtime-network-stats').data('iCount');
		$('#realtime-network-stats').data('iCount', count + 1);

		chart_data.shift();
		chart_data.push({id: count + 1, x1: between(min_max[0],min_max[1]), x2: between(min_max2[0],min_max2[1])});

		$('#realtime-network-stats').dxChart('instance').option('dataSource', chart_data);
	}

	function networkRealtimeGaugeTick(){
		var nr_gauge = jQuery('#network-realtime-gauge').dxCircularGauge('instance');
		nr_gauge.value( between(25,50) );
	}

	function networkRealtimeMBupdate()						//改变设备温度
	{
		var $el = jQuery("#network-mbs-packets"),
			options = {
				useEasing : true,
				useGrouping : true,
				separator : ',',
				decimal : '.',
				prefix : '' ,
				suffix : '℃'
			},
			cntr = new countUp($el[0], parseFloat($el.text().replace('mb/s')), parseFloat(between(10,25) + 1/between(15,30)), 2, 1.5, options);
		cntr.start();
	}
//---------------------------------------------------------------------------------------------------------------------控制函数
	function switchChannel(up){											//切换频道
		var value = jQuery('#network-mbs-packets1').text();
		var num = parseInt(value);
		if(up == 1){
			num++;
			num %= 10;
			jQuery('#network-mbs-packets1').text(num);
		}
		else{
			num += 9;
			num %= 10;
			jQuery('#network-mbs-packets1').text(num);
		}
		$.ajax({
			url: '/set_device/',
			data: {
				'request':JSON.stringify({
					'token': jQuery("#info_token").val(),
					'email': jQuery("#info_email").val(),
					'code': jQuery("#info_code").val(),
					'set':{
						'station': num
					}
				})
			},
			type: 'POST',
			success: function(response){
				console.log("成功");
			},
			error: function(error){
				console.log("失败");
			}
		})
	}

	function closeEquipment(){
		console.log("关闭");
		$.ajax({
			url: '/set_device/',
			data: {
				'request':JSON.stringify({
					'token': jQuery("#info_token").val(),
					'email': jQuery("#info_email").val(),
					'code': jQuery("#info_code").val(),
					'set':{
						'Work': false
					}
				})
			},
			type: 'POST',
			success: function(response){
				console.log("成功");
			},
			error: function(error){
				console.log("失败");
			}
		})
	}

	function upperEquipmentInterval(){										//提高刷新间隔
		var inte_str = $('#interval').val();
		var interv = parseInt(inte_str);
		if(interv == 10){
			return;
		}
		console.log(interv+1);
		$.ajax({
			url: '/set_device/',
			data: {
				'request':JSON.stringify({
					'token': jQuery("#info_token").val(),
					'email': jQuery("#info_email").val(),
					'code': jQuery("#info_code").val(),
					'set':{
						'interval': interv + 1
					}
				})
			},
			type: 'POST',
			success: function(response){
				console.log("成功");
				$('#interval_time').val(interv+1);
			},
			error: function(error){
			    console.log("失败");
			}
		})
	}

	function lowerEquipmentInterval(){
		var inte_str = $('#interval').val();
		var interv = parseInt(inte_str);
		if(interv == 1){
			return;
		}
		console.log(interv - 1);
		$.ajax({
			url: '/set_device/',
			data: {
				'request':JSON.stringify({
					'token': jQuery("#info_token").val(),
					'email': jQuery("#info_email").val(),
					'code': jQuery("#info_code").val(),
					'set':{
						'interval': interv - 1
					}
				})
			},
			type: 'POST',
			success: function(response){
			    console.log("成功");
				$('#interval_time').val(interv-1);
			},
			error: function(error){
				console.log("失败");
			}
		})
	}

	function between(randNumMin, randNumMax) {
		var randInt = Math.floor((Math.random() * ((randNumMax + 1) - randNumMin)) + randNumMin);
		return randInt;
	}
</script>


			
			<!-- Main Footer -->
			<!-- Choose between footer styles: "footer-type-1" or "footer-type-2" -->
			<!-- Add class "sticky" to  always stick the footer to the end of page (if page contents is small) -->
			<!-- Or class "fixed" to  always fix the footer to the end of page -->
			<footer class="main-footer sticky footer-type-1">
				
				<div class="footer-inner">
				
					<!-- Add your copyright text here -->
					<div class="footer-text">
						&copy; 2014 
						<strong>Xenon</strong> 
						More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a>
					</div>
					
					
					<!-- Go to Top Link, just add rel="go-top" to any link to add this functionality -->
					<div class="go-up">
					
						<a href="#" rel="go-top">
							<i class="fa-angle-up"></i>
						</a>
						
					</div>
					
				</div>
				
			</footer>
		</div>

	</div>
	
	
	<div class="page-loading-overlay">
		<div class="loader-2"></div>
	</div>

	<link rel="stylesheet" href="assets/js/jquery-ui/jquery-ui.min.css">

	<!-- Bottom Scripts -->
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/TweenMax.min.js"></script>
	<script src="assets/js/resizeable.js"></script>
	<script src="assets/js/joinable.js"></script>
	<script src="assets/js/xenon-api.js"></script>
	<script src="assets/js/xenon-toggles.js"></script>

	<!-- Imported scripts on this page -->
	<script src="assets/js/xenon-widgets.js"></script>
	<script src="assets/js/devexpress-web-14.1/js/globalize.min.js"></script>
	<script src="assets/js/devexpress-web-14.1/js/dx.chartjs.js"></script>
	<script src="assets/js/toastr/toastr.min.js"></script>
	<script src="assets/js/knob/jquery.knob.min.js"></script>

	<!-- JavaScripts initializations and stuff -->
	<script src="assets/js/xenon-custom.js"></script>

</body>
</html>